<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 7 Modelos con respuesta no normal | Modelización estadística avanzada con R: análisis de datos longitudinales</title>
  <meta name="description" content="Capítulo 7 Modelos con respuesta no normal | Modelización estadística avanzada con R: análisis de datos longitudinales" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 7 Modelos con respuesta no normal | Modelización estadística avanzada con R: análisis de datos longitudinales" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 7 Modelos con respuesta no normal | Modelización estadística avanzada con R: análisis de datos longitudinales" />
  
  
  

<meta name="author" content="Juan R González" />


<meta name="date" content="2022-03-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelos-lineales-mixtos-lmm.html"/>
<link rel="next" href="análisis-de-supervivencia-con-datos-longitudinales.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.18/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Datos Longitudinales</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preámbulo</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#instalación-de-librerías-necesarias-para-el-curso"><i class="fa fa-check"></i><b>1.1</b> Instalación de librerías necesarias para el curso</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introducción a los diseños de datos longitudinales</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#definición"><i class="fa fa-check"></i><b>2.1</b> Definición</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#ejemplos"><i class="fa fa-check"></i><b>2.2</b> Ejemplos</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#esquemas-de-recogidas-de-datos"><i class="fa fa-check"></i><b>2.3</b> Esquemas de recogidas de datos</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#todas-las-medidas-con-intervalos-fijos"><i class="fa fa-check"></i><b>2.3.1</b> Todas las medidas con intervalos fijos</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#missings-al-azar-con-intervalos-fijos"><i class="fa fa-check"></i><b>2.3.2</b> Missings al azar con intervalos fijos</a></li>
<li class="chapter" data-level="2.3.3" data-path="intro.html"><a href="intro.html#distintos-seguimientos"><i class="fa fa-check"></i><b>2.3.3</b> Distintos seguimientos</a></li>
<li class="chapter" data-level="2.3.4" data-path="intro.html"><a href="intro.html#todas-las-medidas-a-distintos-tiempos"><i class="fa fa-check"></i><b>2.3.4</b> Todas las medidas a distintos tiempos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="estructura-de-los-datos.html"><a href="estructura-de-los-datos.html"><i class="fa fa-check"></i><b>3</b> Estructura de los datos</a>
<ul>
<li class="chapter" data-level="3.1" data-path="estructura-de-los-datos.html"><a href="estructura-de-los-datos.html#formato-ancho-y-largo"><i class="fa fa-check"></i><b>3.1</b> Formato ancho y largo</a></li>
<li class="chapter" data-level="3.2" data-path="estructura-de-los-datos.html"><a href="estructura-de-los-datos.html#formato-ancho"><i class="fa fa-check"></i><b>3.2</b> Formato ancho</a></li>
<li class="chapter" data-level="3.3" data-path="estructura-de-los-datos.html"><a href="estructura-de-los-datos.html#formato-largo"><i class="fa fa-check"></i><b>3.3</b> Formato largo</a></li>
<li class="chapter" data-level="3.4" data-path="estructura-de-los-datos.html"><a href="estructura-de-los-datos.html#valores-faltantes"><i class="fa fa-check"></i><b>3.4</b> Valores faltantes</a></li>
<li class="chapter" data-level="3.5" data-path="estructura-de-los-datos.html"><a href="estructura-de-los-datos.html#tiempos-de-medidas-diferentes"><i class="fa fa-check"></i><b>3.5</b> Tiempos de medidas diferentes</a></li>
<li class="chapter" data-level="3.6" data-path="estructura-de-los-datos.html"><a href="estructura-de-los-datos.html#transformación"><i class="fa fa-check"></i><b>3.6</b> Transformación</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="estructura-de-los-datos.html"><a href="estructura-de-los-datos.html#vertical-a-horizontal-y-viceversa"><i class="fa fa-check"></i><b>3.6.1</b> Vertical a horizontal y viceversa</a></li>
<li class="chapter" data-level="3.6.2" data-path="estructura-de-los-datos.html"><a href="estructura-de-los-datos.html#colapsar"><i class="fa fa-check"></i><b>3.6.2</b> Colapsar</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="visualización-de-datos-longitudinales.html"><a href="visualización-de-datos-longitudinales.html"><i class="fa fa-check"></i><b>4</b> Visualización de datos longitudinales</a>
<ul>
<li class="chapter" data-level="4.1" data-path="visualización-de-datos-longitudinales.html"><a href="visualización-de-datos-longitudinales.html#trayectorias"><i class="fa fa-check"></i><b>4.1</b> Trayectorias</a></li>
<li class="chapter" data-level="4.2" data-path="visualización-de-datos-longitudinales.html"><a href="visualización-de-datos-longitudinales.html#spaghetti-plots"><i class="fa fa-check"></i><b>4.2</b> Spaghetti plots</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ModelosNormal.html"><a href="ModelosNormal.html"><i class="fa fa-check"></i><b>5</b> Modelos con respuesta normal</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ModelosNormal.html"><a href="ModelosNormal.html#técnica-de-la-suma-de-cuadrados"><i class="fa fa-check"></i><b>5.1</b> Técnica de la suma de cuadrados</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="ModelosNormal.html"><a href="ModelosNormal.html#diseño-1w1b"><i class="fa fa-check"></i><b>5.1.1</b> Diseño 1W+1B</a></li>
<li class="chapter" data-level="5.1.2" data-path="ModelosNormal.html"><a href="ModelosNormal.html#diseño-1w"><i class="fa fa-check"></i><b>5.1.2</b> Diseño 1W</a></li>
<li class="chapter" data-level="5.1.3" data-path="ModelosNormal.html"><a href="ModelosNormal.html#función-ezanova"><i class="fa fa-check"></i><b>5.1.3</b> Función <code>ezANOVA</code></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="ModelosNormal.html"><a href="ModelosNormal.html#respuesta-multivariante"><i class="fa fa-check"></i><b>5.2</b> Respuesta Multivariante</a></li>
<li class="chapter" data-level="5.3" data-path="ModelosNormal.html"><a href="ModelosNormal.html#ejemplos-1"><i class="fa fa-check"></i><b>5.3</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="ModelosNormal.html"><a href="ModelosNormal.html#Ejemplo1"><i class="fa fa-check"></i><b>5.3.1</b> Ejemplo 1</a></li>
<li class="chapter" data-level="5.3.2" data-path="ModelosNormal.html"><a href="ModelosNormal.html#Ejemplo2"><i class="fa fa-check"></i><b>5.3.2</b> Ejemplo 2</a></li>
<li class="chapter" data-level="5.3.3" data-path="ModelosNormal.html"><a href="ModelosNormal.html#Ejemplo3"><i class="fa fa-check"></i><b>5.3.3</b> Ejemplo 3</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="ModelosNormal.html"><a href="ModelosNormal.html#ejercicios"><i class="fa fa-check"></i><b>5.4</b> Ejercicios</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="ModelosNormal.html"><a href="ModelosNormal.html#ejercicio-1"><i class="fa fa-check"></i><b>5.4.1</b> Ejercicio 1</a></li>
<li class="chapter" data-level="5.4.2" data-path="ModelosNormal.html"><a href="ModelosNormal.html#ejercicio-2"><i class="fa fa-check"></i><b>5.4.2</b> Ejercicio 2</a></li>
<li class="chapter" data-level="5.4.3" data-path="ModelosNormal.html"><a href="ModelosNormal.html#ejercicio-3"><i class="fa fa-check"></i><b>5.4.3</b> Ejercicio 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="modelos-lineales-mixtos-lmm.html"><a href="modelos-lineales-mixtos-lmm.html"><i class="fa fa-check"></i><b>6</b> Modelos Lineales Mixtos (LMM)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="modelos-lineales-mixtos-lmm.html"><a href="modelos-lineales-mixtos-lmm.html#ecuación"><i class="fa fa-check"></i><b>6.1</b> Ecuación</a></li>
<li class="chapter" data-level="6.2" data-path="modelos-lineales-mixtos-lmm.html"><a href="modelos-lineales-mixtos-lmm.html#casos-particulares"><i class="fa fa-check"></i><b>6.2</b> Casos particulares</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="modelos-lineales-mixtos-lmm.html"><a href="modelos-lineales-mixtos-lmm.html#modelo-con-constante-aleatoria"><i class="fa fa-check"></i><b>6.2.1</b> Modelo con constante aleatoria</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="modelos-lineales-mixtos-lmm.html"><a href="modelos-lineales-mixtos-lmm.html#simplificación-del-modelo"><i class="fa fa-check"></i><b>6.3</b> Simplificación del modelo</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="modelos-lineales-mixtos-lmm.html"><a href="modelos-lineales-mixtos-lmm.html#significación-de-los-efectos-aleatorios"><i class="fa fa-check"></i><b>6.3.1</b> Significación de los efectos aleatorios</a></li>
<li class="chapter" data-level="6.3.2" data-path="modelos-lineales-mixtos-lmm.html"><a href="modelos-lineales-mixtos-lmm.html#elección-matriz-covarianzas-de-los-efectos-aleatorios"><i class="fa fa-check"></i><b>6.3.2</b> Elección matriz covarianzas de los efectos aleatorios</a></li>
<li class="chapter" data-level="6.3.3" data-path="modelos-lineales-mixtos-lmm.html"><a href="modelos-lineales-mixtos-lmm.html#estructura-de-correlación-de-los-errores"><i class="fa fa-check"></i><b>6.3.3</b> Estructura de correlación de los errores</a></li>
<li class="chapter" data-level="6.3.4" data-path="modelos-lineales-mixtos-lmm.html"><a href="modelos-lineales-mixtos-lmm.html#efectos-fijos"><i class="fa fa-check"></i><b>6.3.4</b> Efectos fijos</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="modelos-lineales-mixtos-lmm.html"><a href="modelos-lineales-mixtos-lmm.html#validación-del-modelo"><i class="fa fa-check"></i><b>6.4</b> Validación del modelo</a></li>
<li class="chapter" data-level="6.5" data-path="modelos-lineales-mixtos-lmm.html"><a href="modelos-lineales-mixtos-lmm.html#predicciones"><i class="fa fa-check"></i><b>6.5</b> Predicciones</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="modelos-lineales-mixtos-lmm.html"><a href="modelos-lineales-mixtos-lmm.html#efectos-marginales"><i class="fa fa-check"></i><b>6.5.1</b> Efectos marginales</a></li>
<li class="chapter" data-level="6.5.2" data-path="modelos-lineales-mixtos-lmm.html"><a href="modelos-lineales-mixtos-lmm.html#estimación-de-los-efectos-aleatorios"><i class="fa fa-check"></i><b>6.5.2</b> Estimación de los efectos aleatorios</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="modelos-lineales-mixtos-lmm.html"><a href="modelos-lineales-mixtos-lmm.html#función-lme"><i class="fa fa-check"></i><b>6.6</b> Función <code>lme</code></a></li>
<li class="chapter" data-level="6.7" data-path="modelos-lineales-mixtos-lmm.html"><a href="modelos-lineales-mixtos-lmm.html#ejemplos-2"><i class="fa fa-check"></i><b>6.7</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="modelos-lineales-mixtos-lmm.html"><a href="modelos-lineales-mixtos-lmm.html#ejemplo-1"><i class="fa fa-check"></i><b>6.7.1</b> Ejemplo 1</a></li>
<li class="chapter" data-level="6.7.2" data-path="modelos-lineales-mixtos-lmm.html"><a href="modelos-lineales-mixtos-lmm.html#ejemplo-2"><i class="fa fa-check"></i><b>6.7.2</b> Ejemplo 2</a></li>
<li class="chapter" data-level="6.7.3" data-path="modelos-lineales-mixtos-lmm.html"><a href="modelos-lineales-mixtos-lmm.html#ejemplo-3"><i class="fa fa-check"></i><b>6.7.3</b> Ejemplo 3</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="modelos-lineales-mixtos-lmm.html"><a href="modelos-lineales-mixtos-lmm.html#ejercicios-1"><i class="fa fa-check"></i><b>6.8</b> Ejercicios</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="modelos-lineales-mixtos-lmm.html"><a href="modelos-lineales-mixtos-lmm.html#ejercicio-4"><i class="fa fa-check"></i><b>6.8.1</b> Ejercicio 4</a></li>
<li class="chapter" data-level="6.8.2" data-path="modelos-lineales-mixtos-lmm.html"><a href="modelos-lineales-mixtos-lmm.html#ejercicio-5"><i class="fa fa-check"></i><b>6.8.2</b> Ejercicio 5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ModelosNoNormal.html"><a href="ModelosNoNormal.html"><i class="fa fa-check"></i><b>7</b> Modelos con respuesta no normal</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ModelosNoNormal.html"><a href="ModelosNoNormal.html#distribución-de-la-variable-respuesta"><i class="fa fa-check"></i><b>7.1</b> Distribución de la variable respuesta</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="ModelosNoNormal.html"><a href="ModelosNoNormal.html#distribución-binomial"><i class="fa fa-check"></i><b>7.1.1</b> Distribución Binomial</a></li>
<li class="chapter" data-level="7.1.2" data-path="ModelosNoNormal.html"><a href="ModelosNoNormal.html#distribución-poisson"><i class="fa fa-check"></i><b>7.1.2</b> Distribución Poisson</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="ModelosNoNormal.html"><a href="ModelosNoNormal.html#modelos-lineales-generalizados-mixtos"><i class="fa fa-check"></i><b>7.2</b> Modelos lineales generalizados mixtos</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="ModelosNoNormal.html"><a href="ModelosNoNormal.html#ecuación-1"><i class="fa fa-check"></i><b>7.2.1</b> Ecuación</a></li>
<li class="chapter" data-level="7.2.2" data-path="ModelosNoNormal.html"><a href="ModelosNoNormal.html#predicciones-1"><i class="fa fa-check"></i><b>7.2.2</b> Predicciones</a></li>
<li class="chapter" data-level="7.2.3" data-path="ModelosNoNormal.html"><a href="ModelosNoNormal.html#función-glmer"><i class="fa fa-check"></i><b>7.2.3</b> Función <code>glmer</code></a></li>
<li class="chapter" data-level="7.2.4" data-path="ModelosNoNormal.html"><a href="ModelosNoNormal.html#función-mixed_model"><i class="fa fa-check"></i><b>7.2.4</b> Función <code>mixed_model</code></a></li>
<li class="chapter" data-level="7.2.5" data-path="ModelosNoNormal.html"><a href="ModelosNoNormal.html#ejemplo"><i class="fa fa-check"></i><b>7.2.5</b> Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ModelosNoNormal.html"><a href="ModelosNoNormal.html#generalized-estimation-equations"><i class="fa fa-check"></i><b>7.3</b> <em>Generalized Estimation Equations</em></a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="ModelosNoNormal.html"><a href="ModelosNoNormal.html#ecuación-2"><i class="fa fa-check"></i><b>7.3.1</b> Ecuación</a></li>
<li class="chapter" data-level="7.3.2" data-path="ModelosNoNormal.html"><a href="ModelosNoNormal.html#función-geeglm"><i class="fa fa-check"></i><b>7.3.2</b> Función <code>geeglm</code></a></li>
<li class="chapter" data-level="7.3.3" data-path="ModelosNoNormal.html"><a href="ModelosNoNormal.html#ejemplos-3"><i class="fa fa-check"></i><b>7.3.3</b> Ejemplos</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="ModelosNoNormal.html"><a href="ModelosNoNormal.html#ejercicios-2"><i class="fa fa-check"></i><b>7.4</b> Ejercicios</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="ModelosNoNormal.html"><a href="ModelosNoNormal.html#ejercicio-5b"><i class="fa fa-check"></i><b>7.4.1</b> Ejercicio 5b</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="análisis-de-supervivencia-con-datos-longitudinales.html"><a href="análisis-de-supervivencia-con-datos-longitudinales.html"><i class="fa fa-check"></i><b>8</b> Análisis de supervivencia con datos longitudinales</a>
<ul>
<li class="chapter" data-level="8.1" data-path="análisis-de-supervivencia-con-datos-longitudinales.html"><a href="análisis-de-supervivencia-con-datos-longitudinales.html#tiempo-hasta-evento"><i class="fa fa-check"></i><b>8.1</b> Tiempo hasta evento</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="análisis-de-supervivencia-con-datos-longitudinales.html"><a href="análisis-de-supervivencia-con-datos-longitudinales.html#ejemplos-4"><i class="fa fa-check"></i><b>8.1.1</b> Ejemplos</a></li>
<li class="chapter" data-level="8.1.2" data-path="análisis-de-supervivencia-con-datos-longitudinales.html"><a href="análisis-de-supervivencia-con-datos-longitudinales.html#otros-tipos-de-censura"><i class="fa fa-check"></i><b>8.1.2</b> Otros tipos de censura</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="análisis-de-supervivencia-con-datos-longitudinales.html"><a href="análisis-de-supervivencia-con-datos-longitudinales.html#kaplan-meier"><i class="fa fa-check"></i><b>8.2</b> Kaplan-Meier</a></li>
<li class="chapter" data-level="8.3" data-path="análisis-de-supervivencia-con-datos-longitudinales.html"><a href="análisis-de-supervivencia-con-datos-longitudinales.html#funciones-involucradas-en-el-análisis-de-supervivencia"><i class="fa fa-check"></i><b>8.3</b> Funciones involucradas en el análisis de supervivencia</a></li>
<li class="chapter" data-level="8.4" data-path="análisis-de-supervivencia-con-datos-longitudinales.html"><a href="análisis-de-supervivencia-con-datos-longitudinales.html#modelo-de-regresión-de-cox"><i class="fa fa-check"></i><b>8.4</b> Modelo de regresión de Cox</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="análisis-de-supervivencia-con-datos-longitudinales.html"><a href="análisis-de-supervivencia-con-datos-longitudinales.html#efectos-tiempo-dependientes"><i class="fa fa-check"></i><b>8.4.1</b> Efectos tiempo-dependientes</a></li>
<li class="chapter" data-level="8.4.2" data-path="análisis-de-supervivencia-con-datos-longitudinales.html"><a href="análisis-de-supervivencia-con-datos-longitudinales.html#variables-tiempo-dependientes-datos-longitudinales"><i class="fa fa-check"></i><b>8.4.2</b> Variables tiempo-dependientes (datos longitudinales)</a></li>
<li class="chapter" data-level="8.4.3" data-path="análisis-de-supervivencia-con-datos-longitudinales.html"><a href="análisis-de-supervivencia-con-datos-longitudinales.html#estructura-de-los-datos-1"><i class="fa fa-check"></i><b>8.4.3</b> Estructura de los datos</a></li>
<li class="chapter" data-level="8.4.4" data-path="análisis-de-supervivencia-con-datos-longitudinales.html"><a href="análisis-de-supervivencia-con-datos-longitudinales.html#ajuste-del-modelo"><i class="fa fa-check"></i><b>8.4.4</b> Ajuste del modelo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="joint-models-para-datos-longitudinales-y-datos-de-supervivencia.html"><a href="joint-models-para-datos-longitudinales-y-datos-de-supervivencia.html"><i class="fa fa-check"></i><b>9</b> Joint models para datos longitudinales y datos de supervivencia</a>
<ul>
<li class="chapter" data-level="9.1" data-path="joint-models-para-datos-longitudinales-y-datos-de-supervivencia.html"><a href="joint-models-para-datos-longitudinales-y-datos-de-supervivencia.html#por-qué-deberíamos-utilizar-este-tipo-de-modelos"><i class="fa fa-check"></i><b>9.1</b> ¿Por qué deberíamos utilizar este tipo de modelos?</a></li>
<li class="chapter" data-level="9.2" data-path="joint-models-para-datos-longitudinales-y-datos-de-supervivencia.html"><a href="joint-models-para-datos-longitudinales-y-datos-de-supervivencia.html#joint-models"><i class="fa fa-check"></i><b>9.2</b> Joint models</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modelización estadística avanzada con R: análisis de datos longitudinales</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ModelosNoNormal" class="section level1" number="7">
<h1><span class="header-section-number">Capítulo 7</span> Modelos con respuesta no normal</h1>
<p>En este capítulo veremos los modelos estadísticos para analizar medidas repetidas cuando la variable respuesta no es normal.
En concreto, nos centraremos sobretodo cuando la variable respuesta es binaria: sí/no, caso/control, evento/no evento, …
No se estudiará el caso de tener eventos censurados de estudios de cohorte o de seguimiento.</p>
<p>En cuanto a los modelos de regresión que veremos serán:</p>
<ul>
<li><p>Modelos lineales generalizados mixtos (GLMM)</p></li>
<li><p><em>Generalized Estimation Equations</em> (GEE).</p></li>
</ul>
<div id="distribución-de-la-variable-respuesta" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Distribución de la variable respuesta</h2>
<p>Cuando se habla <strong>“generalizado”</strong>, se entienden toda una familia de distribuiones entre las cuales se incluyen la <strong>Binomial</strong> (o binaria), la <strong>Poisson</strong> (propia de contajes) y también la distribución <strong>Normal</strong>, entre otras.</p>
<p>No incluye la distribución de Weibull (propia de análisis de supervivencia). Tampoco veremos extensiones como la censura, truncamiento o inflación en el cero.</p>
<div id="distribución-binomial" class="section level3" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Distribución Binomial</h3>
<p><span class="math display">\[Y \sim B(n, p), \quad P(Y=k) = \begin{pmatrix} n \\ k \end{pmatrix} p^k (1-p)^{n-k}\]</span></p>
<p>Donde <span class="math inline">\(n\)</span> es el número de ensayos y <span class="math inline">\(p\)</span> es la probabilidad del éxito en cada ensayo.</p>
<p>Cuando <span class="math inline">\(n\)</span>=1 tenemos la distribución de Bernoulli.</p>
<p>La regresión logística es el modelo que para predecir respuesta Bernoulli o Binomial, donde la relación entre las variables independientes y el valor esperado de la variable respuesta es la función logística (link canónico).</p>
<p><span class="math display">\[g(E(Y))=\text{logit}(p) = \log\left(\frac{p}{1-p}\right) = \beta_0 + \sum_{k=1}^K \beta_k x_k\]</span>
donde <span class="math inline">\(g\)</span> es la función link que en el caso de la regresión logística corresponde a la <strong>función logit</strong>.</p>
<p>El término <span class="math inline">\(\frac{p}{1-p}\)</span> se conoce como el odds del evento. De aquí se deriva que <span class="math inline">\(e^{\beta_k}\)</span> sea el <strong>Odds Ratio</strong> de la variable <span class="math inline">\(x_k\)</span>.</p>
<p>En la regresión logística, para obtener <strong>las predicciones</strong> o valor esperado:</p>
<p><span class="math display">\[E(Y) = p = \frac{1}{1+\text{exp} \left(-(\beta_0 + \sum_{k=1}^K \beta_k x_k)\right)}\]</span></p>
</div>
<div id="distribución-poisson" class="section level3" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Distribución Poisson</h3>
<p><span class="math display">\[Y \sim \text{Pois}(\lambda), \quad P(Y=k) = \frac{\lambda^k e^{-\lambda}}{k!}\]</span>
Donde <span class="math inline">\(\lambda\)</span> es la incidencia o riesgo y coincide con la esperanza.</p>
<p>La regresión log-lineal es el modelo asociado a la distribución de Poisson que asocia la <span class="math inline">\(\lambda\)</span> con las variables independientes mediante el link logarítmico (link canónico).</p>
<p><span class="math display">\[\log(\lambda) = \beta_0 + \sum_{k=1}^K \beta_k x_k\]</span>
De aquí que <span class="math inline">\(e^{\beta_k}\)</span> es el riesgo relativo de la variable <span class="math inline">\(x_k\)</span>.</p>
<p>La función link para la regresión log-lineal de Poisson es el función logarítmica.</p>
<p>Para la regresión log-lineal de Poisson, <strong>las predicciones</strong> se obtienen como:</p>
<p><span class="math display">\[E(Y) = \lambda = \exp \left( \beta_0 + \sum_{k=1}^K \beta_k x_k \right)\]</span></p>
</div>
</div>
<div id="modelos-lineales-generalizados-mixtos" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Modelos lineales generalizados mixtos</h2>
<div id="ecuación-1" class="section level3" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Ecuación</h3>
<p>Los modelos lineales generalizados mixtos, <em>Generalized Linear Mixed Models</em> (GLMM), son una generalización de los modelos lineales para respuesta dentro de la família exponencial.</p>
<p>Cuando la respuesta no es normal la ecuación del modelo es</p>
<p><span class="math display">\[g(E(y_{ij} | x_{ijk},\color{blue}{\beta_{0i},\cdots,\beta_{Ki}})) = \beta_{0i} + \sum_{k=1}^K \beta_{ki} x_{ijk}\]</span>
Donde <span class="math inline">\(g\)</span> es la función link.</p>
<p>Fíjate que la ecuación es muy similar a lo de los modelos LMM. Sin embargo las diferencias son importantes:</p>
<ul>
<li><p>A la izquierda de la igualdad no hay la variable respuesta, <span class="math inline">\(Y\)</span>, sino el link del valor esperado, <span class="math inline">\(\text{link}(E(y_{ij}))\)</span>.</p></li>
<li><p>A la derecha del igual no aparecen los errores. Por lo tanto <strong>no habrá matriz de correlaciones de los residuos</strong>.</p></li>
</ul>
<p>Como en los LMM, <span class="math inline">\(\beta_{01}\)</span> es la constante aleatoria y <span class="math inline">\(\beta_{ki}\)</span> son las pendientes o coeficientes aleatorios. El vector formado por la constante y pendientes aleatorios son los efectos aleatorios y también siguen una distribución normal:</p>
<p><span class="math display">\[\vec{\beta}_i = (\beta_{0i},\beta_{1i},\ldots,\beta_{Ki})^t \sim N(\vec{\beta}, \Omega), \quad \forall i\]</span></p>
</div>
<div id="predicciones-1" class="section level3" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Predicciones</h3>
<p>Existen dos tipus de predicciones que serán diferentes:</p>
<ol style="list-style-type: decimal">
<li>Las predicciones en el valor esperado de los efectos aleatorios, o sea en un “individuo promedio”</li>
</ol>
<ul>
<li>para regresión logística</li>
</ul>
<p><span class="math display">\[E(y_{ij}|x_{ijk}, \color{blue}{\beta_0,\cdots,\beta_K}) = \frac{1}{1+\text{exp} \left(-(\color{blue}{\beta_{0}} + \sum_{k=1}^K \color{blue}{\beta_{k}} x_{ijk}) \right)}\]</span>
- para regresión log-lineal de Poisson</p>
<p><span class="math display">\[E(y_{ij}|x_{ijk}, \color{blue}{\beta_0,\cdots,\beta_K}) = \text{exp} \left(\color{blue}{\beta_{0}} + \sum_{k=1}^K \color{blue}{\beta_{k}} x_{ijk} \right)\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li>Las predicciones promedio o marginales</li>
</ol>
<ul>
<li>para regresión logística</li>
</ul>
<p><span class="math display">\[E(y_{ij}|x_{ijk}) = \int_{-\infty}^{-\infty} \cdots \int_{-\infty}^{-\infty} \frac{1}{1+\text{exp} \left(-(\color{blue}{\beta_{0i}} + \sum_{k=1}^K \color{blue}{\beta_{ki}} x_{ijk}) \right)} \phi(\beta_{0i},\ldots,\beta_{Ki})\]</span></p>
<ul>
<li>para regresión logística</li>
</ul>
<p><span class="math display">\[E(y_{ij}|x_{ijk}) = \int_{-\infty}^{-\infty} \cdots \int_{-\infty}^{-\infty} \text{exp} \left(\color{blue}{\beta_{0i}} + \sum_{k=1}^K \color{blue}{\beta_{ki}} x_{ijk} \right) \phi(\beta_{0i},\ldots,\beta_{Ki})\]</span></p>
<p>Donde <span class="math inline">\(\phi()\)</span> es la función de densidad multivariante de los efectos aleatorios.
Esta predicción es computacionalmente mucho más difícil de calcular ya que requiere de integración múltiple y require de métodos numéricos intensivos.</p>
<p><strong>Interpretación de los OR/RR</strong></p>
<p>Supongamos un modelo con una sola variable independiente (sexo), y en que se considera la constante aleatoria:</p>
<p><span class="math display">\[g(E(y_{ij}|x_{i},\beta_{0i})) = \beta_{0i} + \beta_1 x_i\]</span>
donde <span class="math inline">\(x_i\)</span> puede tomar valores de 0 (hombre) o 1 (mujer).</p>
<p>El Odds Ratio (OR) o el Riesgo Relativo (RR) de la variable <span class="math inline">\(x\)</span> para la regresión logística o para la regresión log-lineal de Poisson respectivamente son</p>
<p><span class="math display">\[\text{RR ó OR} = \frac{e^{\beta_{0\color{blue}{i}} + \beta_1}}{e^{\beta_{0\color{red}{j}}}}  = e^{\beta_{0i}-\beta_{0j}} e^{\beta_1}\]</span></p>
<p>Fíjate que las constante aleatoria <span class="math inline">\(\beta_{0i}\)</span> es distinto en el numerador que en denominador ya que el individuo está anidado a la variable sexo cada individuo es de una categoría de sexo pero no puede ser de ambas.</p>
<p>Luego el RR o el OR depende de los efectos aleatorio de la constante. Si tomamos el valor esperado del RR o del OR:</p>
<p><span class="math display">\[E(\text{RR ó OR}) =  e^{\beta_1}\cdot E\left(e^{\beta_{0i}-\beta_{0j}}\right) = e^{\beta_1}\cdot \color{blue}{e^{\sigma_{\beta_{0}}^2}} \]</span></p>
<p>ya que <span class="math inline">\(\beta_{0i}-\beta_{0j} \sim N\left(0, 2\sigma_{\beta_{0}}^2\right)\)</span>.</p>
<p>Por lo tanto, cuanta más variabilidad haya entre individuos (<span class="math inline">\(\sigma_{\beta_{0}}^2\)</span>), mayor es la discrepancia entre <span class="math inline">\(e^{\beta_1}\)</span> el OR (ó RR) marginal.</p>
<p>Nota que para la regresión lineal los efectos aleatorios se cancelan: <span class="math inline">\(E(y|mujeres)-E(y|hombres) = \beta_1 + E(\beta_{0i})-E(\beta_{0j}) = \beta_1 + \beta_{0}-\beta_{0} = \beta_1\)</span>.</p>
<p>Pero <strong>cuando el link no es lineal</strong> ésto no sucede y <strong>la interpretación del efecto marginal de una variable depende de la varianza de los efectos aleatorios</strong>.</p>
</div>
<div id="función-glmer" class="section level3" number="7.2.3">
<h3><span class="header-section-number">7.2.3</span> Función <code>glmer</code></h3>
<p>Una de las funciones más conocidas para analizar los datos mediante modelos GLMM para respuesta no normal es la función <strong><code>glmer</code></strong> del paquete <strong><code>lme4</code></strong>.</p>
<p>Esta paquete tiene la función <code>lmer</code> para ajustar modelos LMM. Su sintaxis es similar a <code>lme</code>. No obstante no permite modelizar la matriz de correlaciones de los residuos.</p>
<p>Los argumentos que tiene la función <code>glmer</code>, entre otros:</p>
<ul>
<li><p><code>formula</code>: para especificar tanto los efectos fijos como los efectos aleatorios.</p></li>
<li><p><code>family</code>: para especificar la distribución de la variable respuesta.</p></li>
</ul>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="ModelosNoNormal.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb240-2"><a href="ModelosNoNormal.html#cb240-2" aria-hidden="true" tabindex="-1"></a>?glmer</span></code></pre></div>
<p>La diferencia importante respecto a <code>lme</code> es que no hay un argumento separado para especificar los términos fijos y los aleatorios; los términos aleatorios se especifican dentro del argumento <strong><code>formula</code></strong>:</p>
<pre><code> + (1 | sujeto)</code></pre>
<p>para la constante aleatoria</p>
<pre><code> + (var1 + var2 +...+ var3 | sujeto)</code></pre>
<p>Par constante y pendientes aleatorios.</p>
<p>Otra diferencia es que no existe el argumento <code>correlation</code>, ya que no hay matriz de correlación de los residuos en estos modelos generalizados (respuesta no normal).</p>
<p>Para especificar que no hay correlación entre los efectos aleatorios</p>
<pre><code> + (1 | sujeto) + (0 + var1 | sujeto) + (0 + var2 | sujeto) + (0 + var3 | sujeto)</code></pre>
<p>ó equivalentemente</p>
<pre><code> + (var1 + var2 + var3 || sujeto)</code></pre>
<p>Otro argumento específico en esta función <code>glmer</code> que no estaba en la función <code>lme</code> es el argumento <strong><code>family</code></strong>:</p>
<ul>
<li><code>binomial</code>, <code>binomial()</code> ó <code>"binomial"</code>: para regresión logística</li>
<li><code>poisson</code>, <code>poisson()</code> ó <code>"poisson"</code>: para regresión log-lineal de poisson</li>
</ul>
<p>Al argumento <strong><code>weights</code></strong> de la función <code>glmer</code>, a diferencia de la función <code>lme</code>, hay que pasarle un vector numérico con tantas componentes como observaciones. Por lo tanto, este vector contiene literlmente los pesos que se le quiere dar a cada observación, y no hay necesidad de usar ninguna función intermedia (<code>varident</code>, <code>varPower</code>, …) como pasaba con <code>lme</code>.</p>
<pre><code>glmer(..., weights = pesos, ...)</code></pre>
</div>
<div id="función-mixed_model" class="section level3" number="7.2.4">
<h3><span class="header-section-number">7.2.4</span> Función <code>mixed_model</code></h3>
<p>Una alternativa a <code>glmer</code> es la función <strong><code>mixed_model</code></strong> del paquete <code>GLMMadaptive</code>.</p>
<p>Los argumentos <code>mixed_model</code> son los mismos que <code>lme</code> excepto que no tiene el argumento <code>correlation</code>, ya que, al igual que pasa con <code>glmer</code> no se pueden especificar la correlación de los errores.</p>
<p>Como en la función <code>lme</code> se especifican los efectos fijos y los aleatorios con los argumentos <code>fixed</code> y <code>random</code>, respectivamente, y de la misma forma.</p>
<p>Al igual que ocurre con la función <code>glmer</code>, para especificar que no hay correlación entre los efectos aleatoorios se especifica con <code>||</code></p>
<pre><code>random = ~ tiempo || indiv</code></pre>
<p>Comparado con la función <code>glmer</code>, las implementaciones nuevas son:</p>
<ul>
<li><p>método robusto para calcular los errores estándar de las estimaciones de los coeficientes fijos.</p></li>
<li><p>calcula el intervalo de confianza también de las varianzas de los efectos aleatorios.</p></li>
<li><p>estima predicciones promedio y también los Odds Ratios o Riesgos Relativos marginales</p></li>
<li><p>usa un método más completo de optimización.</p></li>
</ul>
<p>La función <code>mixed_model</code> también tiene implementado el argumento <strong><code>weights</code></strong>. Pero es diferente de la función <code>lme</code> y de la función <code>glmer</code>. Para <code>mixed_model</code> hay que pasarle un vector con tantas componentes como individuos. Así pues, lo que hace <code>mixed_model</code> es ponderar todas las observaciones de un individuo de la misma manera (pondera los individuos en lugar de las observacioens).</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="ModelosNoNormal.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GLMMadaptive)</span>
<span id="cb247-2"><a href="ModelosNoNormal.html#cb247-2" aria-hidden="true" tabindex="-1"></a>?mixed_model</span></code></pre></div>
</div>
<div id="ejemplo" class="section level3" number="7.2.5">
<h3><span class="header-section-number">7.2.5</span> Ejemplo</h3>
<p>Para ilustrar la función <code>mixed_model</code> y también la función <code>glmer</code>, cogemos unos datos simulados (véase la vignette del package <code>GLMMadaptive</code>).</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="ModelosNoNormal.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">help</span>(<span class="at">package=</span><span class="st">&quot;GLMMadaptive&quot;</span>)</span></code></pre></div>
<p>Ahora no nos tendremos que preocupar de especificar bien la matriz de correlaciones de los errores, y sólo de los efectos aleatorios.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="ModelosNoNormal.html#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb249-2"><a href="ModelosNoNormal.html#cb249-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># number of subjects</span></span>
<span id="cb249-3"><a href="ModelosNoNormal.html#cb249-3" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">8</span> <span class="co"># number of measurements per subject</span></span>
<span id="cb249-4"><a href="ModelosNoNormal.html#cb249-4" aria-hidden="true" tabindex="-1"></a>t_max <span class="ot">&lt;-</span> <span class="dv">15</span> <span class="co"># maximum follow-up time</span></span>
<span id="cb249-5"><a href="ModelosNoNormal.html#cb249-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-6"><a href="ModelosNoNormal.html#cb249-6" aria-hidden="true" tabindex="-1"></a><span class="co"># we constuct a data frame with the design: </span></span>
<span id="cb249-7"><a href="ModelosNoNormal.html#cb249-7" aria-hidden="true" tabindex="-1"></a><span class="co"># everyone has a baseline measurment, and then measurements at random follow-up times</span></span>
<span id="cb249-8"><a href="ModelosNoNormal.html#cb249-8" aria-hidden="true" tabindex="-1"></a>DF <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">rep</span>(<span class="fu">seq_len</span>(n), <span class="at">each =</span> K),</span>
<span id="cb249-9"><a href="ModelosNoNormal.html#cb249-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">time =</span> <span class="fu">c</span>(<span class="fu">replicate</span>(n, <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">sort</span>(<span class="fu">runif</span>(K <span class="sc">-</span> <span class="dv">1</span>, <span class="dv">0</span>, t_max))))),</span>
<span id="cb249-10"><a href="ModelosNoNormal.html#cb249-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sex =</span> <span class="fu">rep</span>(<span class="fu">gl</span>(<span class="dv">2</span>, n<span class="sc">/</span><span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;male&quot;</span>, <span class="st">&quot;female&quot;</span>)), <span class="at">each =</span> K))</span>
<span id="cb249-11"><a href="ModelosNoNormal.html#cb249-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-12"><a href="ModelosNoNormal.html#cb249-12" aria-hidden="true" tabindex="-1"></a><span class="co"># design matrices for the fixed and random effects</span></span>
<span id="cb249-13"><a href="ModelosNoNormal.html#cb249-13" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> sex <span class="sc">*</span> time, <span class="at">data =</span> DF)</span>
<span id="cb249-14"><a href="ModelosNoNormal.html#cb249-14" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> time, <span class="at">data =</span> DF)</span>
<span id="cb249-15"><a href="ModelosNoNormal.html#cb249-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-16"><a href="ModelosNoNormal.html#cb249-16" aria-hidden="true" tabindex="-1"></a>betas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.13</span>, <span class="sc">-</span><span class="fl">0.25</span>, <span class="fl">0.24</span>, <span class="sc">-</span><span class="fl">0.05</span>) <span class="co"># fixed effects coefficients</span></span>
<span id="cb249-17"><a href="ModelosNoNormal.html#cb249-17" aria-hidden="true" tabindex="-1"></a>D11 <span class="ot">&lt;-</span> <span class="fl">0.48</span> <span class="co"># variance of random intercepts</span></span>
<span id="cb249-18"><a href="ModelosNoNormal.html#cb249-18" aria-hidden="true" tabindex="-1"></a>D22 <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="co"># variance of random slopes</span></span>
<span id="cb249-19"><a href="ModelosNoNormal.html#cb249-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-20"><a href="ModelosNoNormal.html#cb249-20" aria-hidden="true" tabindex="-1"></a><span class="co"># we simulate random effects</span></span>
<span id="cb249-21"><a href="ModelosNoNormal.html#cb249-21" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fu">sqrt</span>(D11)), <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fu">sqrt</span>(D22)))</span>
<span id="cb249-22"><a href="ModelosNoNormal.html#cb249-22" aria-hidden="true" tabindex="-1"></a><span class="co"># linear predictor</span></span>
<span id="cb249-23"><a href="ModelosNoNormal.html#cb249-23" aria-hidden="true" tabindex="-1"></a>eta_y <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(X <span class="sc">%*%</span> betas <span class="sc">+</span> <span class="fu">rowSums</span>(Z <span class="sc">*</span> b[DF<span class="sc">$</span>id, ]))</span>
<span id="cb249-24"><a href="ModelosNoNormal.html#cb249-24" aria-hidden="true" tabindex="-1"></a><span class="co"># we simulate binary longitudinal data</span></span>
<span id="cb249-25"><a href="ModelosNoNormal.html#cb249-25" aria-hidden="true" tabindex="-1"></a>DF<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n <span class="sc">*</span> K, <span class="dv">1</span>, <span class="fu">plogis</span>(eta_y))</span></code></pre></div>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="ModelosNoNormal.html#cb250-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(DF)</span></code></pre></div>
<div id="htmlwidget-45555ef9b50430bafacd" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-45555ef9b50430bafacd">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","696","697","698","699","700","701","702","703","704","705","706","707","708","709","710","711","712","713","714","715","716","717","718","719","720","721","722","723","724","725","726","727","728","729","730","731","732","733","734","735","736","737","738","739","740","741","742","743","744","745","746","747","748","749","750","751","752","753","754","755","756","757","758","759","760","761","762","763","764","765","766","767","768","769","770","771","772","773","774","775","776","777","778","779","780","781","782","783","784","785","786","787","788","789","790","791","792","793","794","795","796","797","798","799","800"],[1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,55,55,55,55,55,55,55,55,56,56,56,56,56,56,56,56,57,57,57,57,57,57,57,57,58,58,58,58,58,58,58,58,59,59,59,59,59,59,59,59,60,60,60,60,60,60,60,60,61,61,61,61,61,61,61,61,62,62,62,62,62,62,62,62,63,63,63,63,63,63,63,63,64,64,64,64,64,64,64,64,65,65,65,65,65,65,65,65,66,66,66,66,66,66,66,66,67,67,67,67,67,67,67,67,68,68,68,68,68,68,68,68,69,69,69,69,69,69,69,69,70,70,70,70,70,70,70,70,71,71,71,71,71,71,71,71,72,72,72,72,72,72,72,72,73,73,73,73,73,73,73,73,74,74,74,74,74,74,74,74,75,75,75,75,75,75,75,75,76,76,76,76,76,76,76,76,77,77,77,77,77,77,77,77,78,78,78,78,78,78,78,78,79,79,79,79,79,79,79,79,80,80,80,80,80,80,80,80,81,81,81,81,81,81,81,81,82,82,82,82,82,82,82,82,83,83,83,83,83,83,83,83,84,84,84,84,84,84,84,84,85,85,85,85,85,85,85,85,86,86,86,86,86,86,86,86,87,87,87,87,87,87,87,87,88,88,88,88,88,88,88,88,89,89,89,89,89,89,89,89,90,90,90,90,90,90,90,90,91,91,91,91,91,91,91,91,92,92,92,92,92,92,92,92,93,93,93,93,93,93,93,93,94,94,94,94,94,94,94,94,95,95,95,95,95,95,95,95,96,96,96,96,96,96,96,96,97,97,97,97,97,97,97,97,98,98,98,98,98,98,98,98,99,99,99,99,99,99,99,99,100,100,100,100,100,100,100,100],[0,0.142436345340684,1.70555116957985,9.13912099320441,9.33449107222259,9.35069162514992,9.60465907934122,12.9137307533529,0,3.48825759021565,4.24100375385024,7.71376712014899,8.17462253384292,9.99125637346879,10.4038693767507,13.8515022641513,0,2.8008418448735,3.48338865791447,4.00231170002371,4.29334927001037,4.38473760383204,4.74918682244606,12.5594344222918,0,0.599938770756125,2.38569004344754,3.28199311508797,4.54040056094527,7.8854632016737,12.1589782868978,13.7198724900372,0,0.68655394949019,2.71644312422723,3.97780007799156,4.57008304540068,6.84137223637663,7.6096030510962,12.4701757030562,0,3.01872056443244,3.88214727980085,8.30000386107713,9.69609141116962,11.3950595317874,12.1102851047181,14.8822562629357,0,3.65893241018057,4.67736460617743,4.94655263610184,7.27486858726479,7.52996209426783,9.32728797197342,10.1564179093111,0,1.10669820103794,2.29498438420705,4.64529902790673,7.55900232237764,7.56818868219852,10.7590761501342,11.4818968134932,0,0.627859127707779,2.61974735883996,4.75773232989013,7.40941384574398,11.2680029554758,12.7258861565497,12.9725074802991,0,0.206249087350443,0.774699290050194,3.58538590022363,4.62142135715112,7.62821348500438,8.46854759962298,10.5974192591384,0,0.219408835982904,1.34941999451257,1.82220280752517,5.76400031335652,7.78784971218556,11.7468165548053,13.392545725219,0,1.0507874598261,2.13923014816828,4.8096663330216,7.07864581723697,8.16404632525519,10.0274309562519,13.8960071455222,0,2.40042994497344,2.49590670573525,2.94261977775022,4.66306169517338,5.84249677020125,13.4427877434064,13.4787073382176,0,0.400753431022167,1.5793125377968,1.97421201271936,2.01117292628624,4.50298580923118,7.67375371651724,13.5063689423259,0,0.531850905390456,2.00608348008245,3.06294474634342,4.20386664220132,4.64471147046424,8.47614168073051,11.1317948566284,0,0.579639788484201,1.51153561659157,1.94943209295161,2.32592954300344,4.88522886531428,6.53296589618549,10.6995234440546,0,1.82726644095965,1.85206631664187,3.29484931309707,4.18734334409237,13.6963165027555,14.1877968166955,14.2545740772039,0,4.2518931417726,7.29203111375682,11.1641582264565,11.9574068917427,13.7396133563016,14.1354107251391,14.9189736752305,0,1.91150097060017,3.77318551763892,4.77668714476749,7.4544925976079,7.54882756154984,9.51149052358232,14.4333424034994,0,6.34570490685292,7.01688500004821,8.96614925586618,9.47614223929122,13.037374780979,13.6225371819455,13.7147536443081,0,4.86579041113146,5.35480616264977,7.22062422777526,7.54124733852223,9.41216526087373,11.1240028578322,14.7545267210808,0,1.23237098450772,3.42899542534724,6.58563077682629,8.48950225976296,8.65219103288837,12.753973826766,14.7117975982837,0,3.51991892326623,5.63399064936675,6.44165944308043,8.32689946400933,9.02846318786032,14.8225117020775,14.9811121216044,0,1.09074140433222,1.27477106521837,3.37268645991571,6.46524555631913,6.48761096061207,8.63816671189852,9.55947389476933,0,4.87917455029674,5.15359053038992,6.40463649644516,8.76407276024111,10.6325911008753,11.3593355251942,12.0360302890185,0,1.74203661619686,4.54532696516253,5.17245820141397,6.36045312043279,7.18204028788023,8.41330880764872,11.3867997773923,0,0.333102346630767,1.14124984829687,4.65141247725114,9.01071210158989,9.48663673130795,12.6256594865117,14.3398891668767,0,1.92404682515189,9.58366970415227,11.1385404935572,12.1512508182786,12.3277676745784,13.2485936663579,14.8877398087643,0,4.76240732241422,7.92539066984318,9.58806873997673,9.9113195145037,10.9909833082929,12.5205399363767,14.7456603648607,0,3.06603668024763,4.61498610908166,6.06259876862168,7.89462738786824,10.9845282649621,11.5178320370615,14.7844963241369,0,2.77583584771492,4.20562717714347,8.49466135608964,8.5017192189116,9.58039974560961,11.3709209428634,13.9826035662554,0,0.47088184626773,3.87219972442836,5.02267102128826,6.33496013120748,7.18833702849224,10.5112220160663,12.7546787448227,0,2.00324502889998,5.05729864700697,7.41657842765562,7.49319578055292,7.63380922959186,11.9557935604826,12.0320344925858,0,1.6004522703588,3.18361391779035,4.60827525006607,8.50438343128189,8.50668106460944,11.2436888215598,12.1147266787011,0,3.25702072237618,3.66604506969452,6.36163767194375,7.34277665033005,10.3367625991814,14.7031906305347,14.845648391638,0,7.15549558983184,7.97857630765066,8.61469416995533,8.949356416706,11.6028543293942,11.9538576132618,14.4890955090523,0,0.0492349674459547,0.976548664039001,3.93533523310907,3.95829710410908,4.19314063154161,8.44622019678354,8.84274815325625,0,0.443352204747498,1.51058192364872,1.80913356598467,4.02629654388875,7.800767471781,8.99654023814946,12.6695210218895,0,0.23940943996422,0.741917184786871,5.35856495727785,5.63934513833374,11.2143567914609,11.222417105455,11.3843729405198,0,0.38539148401469,4.00026681600139,5.16955983010121,7.59537825244479,8.17134864279069,11.991940633161,12.3184296966065,0,4.21158935758285,5.53763929288834,6.43878126866184,6.85239942278713,11.0674729838502,11.7651722312439,13.7777155986987,0,3.64664190332405,4.31306462385692,6.20257016038522,9.82730297371745,10.4443660145625,12.3113444738556,14.2774412187282,0,1.73141694394872,4.63538052630611,5.29497753130272,9.13027539965697,9.53867496689782,10.4050104261842,11.3692720339168,0,2.85938705317676,6.66050794534385,6.78725057048723,8.08324145385996,14.2405016650446,14.7143747436348,14.8741372441873,0,2.1912418550346,6.10877130646259,6.11388449091464,8.22683171485551,10.2316800307017,11.5322365052998,13.7013250915334,0,2.88314009201713,2.95001571066678,2.97600010642782,5.22331959335133,6.12621600972489,12.5181427260395,12.9270796431229,0,2.2988065041136,2.79505356447771,5.08925074827857,5.50770659465343,5.95777965383604,6.41068624332547,9.87024900619872,0,2.92352302582003,5.79075983958319,7.08925103070214,11.0084109404124,13.2347890734673,13.8061707175802,14.3001979670953,0,0.417834848631173,4.0822926023975,5.61248785816133,6.15793913486414,7.75869740755297,13.9403281768318,14.3376032402739,0,0.513144488213584,0.674843969754875,4.65645658783615,5.54544729413465,10.013487712713,13.8137456530239,14.6746476343833,0,1.95835246704519,3.0169894779101,8.89355848543346,10.6332539068535,11.1527232639492,14.1586956905667,14.9824771704152,0,0.0471819355152547,4.94572717580013,6.90382933826186,7.30101263383403,8.36911947350018,10.9694345458411,11.5222799393814,0,3.50362289347686,9.90772420889698,10.8702734252438,12.2880063042976,12.5321344099939,14.6453572972678,14.6655249455944,0,1.5120246342849,3.97669543046504,4.5820242818445,5.92645498341881,7.31833818485029,11.3900957407895,13.1823006388731,0,0.0322006770875305,1.6176401800476,3.08979749679565,3.22300532832742,4.42896138061769,6.32039535557851,9.86646371427923,0,1.72730510705151,2.89908345323056,10.3073914744891,10.3756045375485,11.098379152827,14.2055696365424,14.7738284000661,0,0.282656208146363,2.50569460331462,8.0474345292896,8.46907268743962,9.78897665860131,10.9866044763476,13.8477128720842,0,2.83048188895918,5.49599441466853,6.24943084898405,8.603805298917,10.2936341171153,11.3553936942481,11.6369230183773,0,1.39024639385752,6.23869802453555,9.3353778985329,11.3739800092299,11.6476630582474,12.1170420292765,14.509444803698,0,1.98814976611175,3.23854876798578,6.17861463222653,6.25377042568289,7.69543073954992,11.6240598075092,13.0051336647011,0,0.810274608666077,1.57864596345462,2.99899909179658,5.16737455967814,9.93071360047907,13.6157965043094,13.9851888280828,0,4.13401954108849,5.08193729678169,6.38760113739409,6.59546050010249,9.95235813315958,11.7584414547309,13.9548580138944,0,4.08310808474198,5.70433941087686,8.85135680087842,9.88543543964624,11.0325139481574,12.2197862213943,14.0308616613038,0,7.52687341184355,8.3290207630489,9.45658895652741,11.1816196306609,13.1955274951179,13.236132444581,14.8275220999494,0,0.50413949531503,3.82051028427668,9.19823297881521,11.263932203874,11.6395320184529,14.4017760234419,14.9736750125885,0,0.743923623813316,3.70329681085423,5.59230217477307,8.60955845215358,9.09844465437345,10.2075579157099,13.4215207316447,0,2.62920114677399,2.88908195332624,5.87657618452795,5.89681258192286,7.75417905882932,8.19763043546118,9.37796245096251,0,0.00918233650736511,2.10928605752997,4.33907503844239,5.99114925018512,8.58307158923708,14.3304557574447,14.655803181231,0,2.13110329583287,7.00741782900877,7.67661298275925,7.85366668947972,8.40631680213846,9.90514208679087,10.8575324050616,0,1.10821389011107,2.04227989772335,2.35584387439303,5.58398552821018,10.5419236945454,11.4226827013772,11.4584289269987,0,4.6203127456829,5.0670694350265,8.99016909766942,9.06375572900288,9.85598813043907,11.4501268020831,13.6897948232945,0,0.752098651137203,1.25932528171688,8.93866539699957,9.08500853343867,10.0337872398086,12.0156494399998,12.8318382811267,0,1.91850188886747,5.3325886989478,10.1165112806484,11.1959747644141,11.9116265710909,12.4434660596307,12.6883994741365,0,1.32411630009301,1.65741396252997,8.88666823622771,9.02734411298297,11.7575320182368,13.9523715886753,14.2212250689045,0,3.71659989352338,4.98121405486017,5.45386384357698,8.44527011853643,9.85893413540907,12.5312854803633,13.8697295053862,0,0.58393110637553,0.597381563857198,3.58630159520544,3.78787503344938,9.36936750076711,9.48814453440718,12.1029803634156,0,1.76194411818869,6.08534701634198,9.74785992410034,9.83416397008114,11.212194354739,11.9770960975438,14.9174592224881,0,3.23788000736386,5.70495174732059,6.48563452181406,7.71409818786196,9.16962405550294,11.2312404450495,14.4900048163254,0,3.35171726765111,3.8622987025883,11.859493770171,12.4289435846731,13.2501077943016,13.7100108980667,14.6968295343686,0,0.597120733000338,2.47642213362269,7.46307338937186,9.37734893755987,12.4557886272669,12.5711378920823,14.5788065856323,0,2.33717410359532,3.62491142819636,10.2132350555621,11.8813000945374,12.9386864590924,12.9704690398648,14.8530562687665,0,0.891181910410523,2.97945934580639,3.12838747515343,9.18487149872817,9.37931157415733,9.98475185246207,12.0589704683516,0,0.903426201548427,5.80444029998034,6.04399169445969,6.30420617759228,8.26645876164548,12.2411357809324,12.5669525912963,0,0.181470952229574,0.580180543474853,4.01179852662608,4.52461293200031,5.37499366560951,8.59047145117074,14.6103560726624,0,1.79985002498142,5.35380282090046,8.94386795000173,9.24090921180323,13.1705177435651,14.2671516956761,14.4725551118609,0,1.83333133463748,2.61282233172096,4.21457721618935,9.37793961726129,9.57285303273238,10.1232969621196,10.4530052875634,0,2.55336655885912,3.13186058658175,5.83780150045641,6.43200887250714,7.64137169346213,8.40815450297669,12.6555961871054,0,1.17195508209988,3.87240096344613,4.60498827975243,5.68002721876837,5.9244799555745,12.0444215764292,14.2016810481437,0,0.748317665420473,4.91178055177443,7.26182432030328,9.97240289230831,10.070363455452,11.6598151274957,13.9417735626921,0,4.66891073738225,5.04921028506942,7.26068863528781,8.98577805259265,12.3826789332088,13.972808875842,14.1907049529254,0,4.3078502418939,6.6083763318602,8.40089438483119,9.11045320797712,12.5176740204915,13.3533511916175,14.0914086566772,0,2.81814073096029,3.88167045079172,5.09006748441607,7.64473392278887,8.35360645665787,12.6534012181219,13.9060992468148,0,0.853405029047281,3.55226490064524,4.6045808843337,5.34430407802574,7.67989437910728,12.0706780871842,13.270973386243,0,0.499599322210997,2.55562100093812,6.75229402142577,7.63044486986473,10.3025300614536,12.9076414613519,13.0502907279879,0,0.739731771172956,3.87232920737006,4.52955312794074,9.22554572462104,12.2339173522778,14.0562942065299,14.2427848186344,0,1.92214576760307,4.26979638752528,6.97423195349984,7.68063913914375,10.6554093619343,10.9408347099088,14.0144302428234,0,3.10111057246104,3.73686183127575,5.90324254939333,6.22833568719216,12.6247881702147,13.3754399511963,14.2104192869738,0,1.65415525669232,4.40244622179307,4.91949653369375,7.17687679454684,9.44030283833854,12.4543983174954,14.2529806250241,0,0.414498921018094,3.33534265402704,7.18410213827156,7.30243271333165,8.10052794171497,13.1051980156917,13.1685677322093,0,0.142889540875331,1.32736284518614,4.54466502531432,4.7786457859911,7.63717357185669,8.17959635169245,11.0982578631956],["male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female","female"],[0,0,0,0,0,0,0,1,0,1,1,1,1,1,1,1,0,0,1,1,1,0,1,1,0,0,0,0,0,0,1,1,0,0,0,0,1,1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,0,1,0,1,1,1,1,0,0,1,1,0,1,1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,1,0,1,0,1,0,1,1,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,1,0,1,1,0,1,1,0,1,1,1,1,1,0,0,0,0,1,1,1,1,0,1,1,0,1,1,1,1,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,1,0,1,1,0,1,1,0,0,0,0,1,0,0,0,0,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,1,0,1,0,0,1,1,1,1,0,1,1,1,1,1,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,1,0,0,1,0,1,1,1,1,1,1,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,1,0,0,0,1,0,0,0,0,1,0,1,1,1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,1,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,0,1,0,0,0,1,0,1,0,0,0,0,1,1,1,1,0,0,0,1,1,1,1,1,0,0,0,0,1,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,1,0,0,1,0,1,1,1,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,1,1,1,0,0,1,0,0,1,1,1,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,1,0,1,0,1,1,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,0,0,0,1,1,0,1,1,1,0,0,0,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,1,1,1,1,1,0,1,0,0,1,1,1,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>id<\/th>\n      <th>time<\/th>\n      <th>sex<\/th>\n      <th>y<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p><strong>Uso de la función <code>glmer</code></strong></p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="ModelosNoNormal.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="do">###################</span></span>
<span id="cb251-2"><a href="ModelosNoNormal.html#cb251-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-3"><a href="ModelosNoNormal.html#cb251-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb251-4"><a href="ModelosNoNormal.html#cb251-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-5"><a href="ModelosNoNormal.html#cb251-5" aria-hidden="true" tabindex="-1"></a>modelo1.glmer <span class="ot">&lt;-</span> <span class="fu">glmer</span>(<span class="at">formula =</span> y <span class="sc">~</span> sex <span class="sc">*</span> time <span class="sc">+</span> (time <span class="sc">|</span> id), </span>
<span id="cb251-6"><a href="ModelosNoNormal.html#cb251-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> DF, </span>
<span id="cb251-7"><a href="ModelosNoNormal.html#cb251-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">family =</span> binomial)</span>
<span id="cb251-8"><a href="ModelosNoNormal.html#cb251-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo1.glmer) <span class="co"># quizá no converge...</span></span></code></pre></div>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: y ~ sex * time + (time | id)
   Data: DF

     AIC      BIC   logLik deviance df.resid 
   737.4    770.2   -361.7    723.4      793 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.4321 -0.3856 -0.2495  0.2682  5.6186 

Random effects:
 Groups Name        Variance Std.Dev. Corr
 id     (Intercept) 0.30005  0.5478       
        time        0.05274  0.2297   1.00
Number of obs: 800, groups:  id, 100

Fixed effects:
                Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    -2.006281   0.277957  -7.218 5.28e-13 ***
sexfemale      -1.161754   0.445313  -2.609  0.00908 ** 
time            0.253460   0.050181   5.051 4.40e-07 ***
sexfemale:time  0.003337   0.071668   0.047  0.96286    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
            (Intr) sexfml time  
sexfemale   -0.561              
time        -0.407  0.227       
sexfemal:tm  0.256 -0.467 -0.689
optimizer (Nelder_Mead) convergence code: 0 (OK)
boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="ModelosNoNormal.html#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="do">## sin correlación entre los efectos aleatorios</span></span>
<span id="cb253-2"><a href="ModelosNoNormal.html#cb253-2" aria-hidden="true" tabindex="-1"></a>modelo2.glmer <span class="ot">&lt;-</span> <span class="fu">glmer</span>(<span class="at">formula =</span> y <span class="sc">~</span> sex<span class="sc">*</span>time <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id) <span class="sc">+</span> (<span class="dv">0</span> <span class="sc">+</span> time <span class="sc">|</span> id), </span>
<span id="cb253-3"><a href="ModelosNoNormal.html#cb253-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> DF, </span>
<span id="cb253-4"><a href="ModelosNoNormal.html#cb253-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">family =</span> binomial)</span>
<span id="cb253-5"><a href="ModelosNoNormal.html#cb253-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo2.glmer)</span></code></pre></div>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: y ~ sex * time + (1 | id) + (0 + time | id)
   Data: DF

     AIC      BIC   logLik deviance df.resid 
   736.8    765.0   -362.4    724.8      794 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.1926 -0.3595 -0.2348  0.2528  4.2005 

Random effects:
 Groups Name        Variance Std.Dev.
 id     (Intercept) 0.93315  0.9660  
 id.1   time        0.07655  0.2767  
Number of obs: 800, groups:  id, 100

Fixed effects:
                Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    -2.129111   0.341967  -6.226 4.78e-10 ***
sexfemale      -1.180758   0.488406  -2.418   0.0156 *  
time            0.268665   0.059755   4.496 6.92e-06 ***
sexfemale:time  0.001354   0.082590   0.016   0.9869    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
            (Intr) sexfml time  
sexfemale   -0.500              
time        -0.556  0.278       
sexfemal:tm  0.298 -0.550 -0.668</code></pre>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="ModelosNoNormal.html#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="co"># o bien</span></span>
<span id="cb255-2"><a href="ModelosNoNormal.html#cb255-2" aria-hidden="true" tabindex="-1"></a>modelo2b.glmer <span class="ot">&lt;-</span> <span class="fu">glmer</span>(<span class="at">formula =</span> y <span class="sc">~</span> sex<span class="sc">*</span>time <span class="sc">+</span> (time <span class="sc">||</span> id),</span>
<span id="cb255-3"><a href="ModelosNoNormal.html#cb255-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> DF, </span>
<span id="cb255-4"><a href="ModelosNoNormal.html#cb255-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">family =</span> binomial)</span>
<span id="cb255-5"><a href="ModelosNoNormal.html#cb255-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo2b.glmer)</span></code></pre></div>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: y ~ sex * time + (time || id)
   Data: DF

     AIC      BIC   logLik deviance df.resid 
   736.8    765.0   -362.4    724.8      794 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.1926 -0.3595 -0.2348  0.2528  4.2005 

Random effects:
 Groups Name        Variance Std.Dev.
 id     (Intercept) 0.93315  0.9660  
 id.1   time        0.07655  0.2767  
Number of obs: 800, groups:  id, 100

Fixed effects:
                Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    -2.129111   0.341967  -6.226 4.78e-10 ***
sexfemale      -1.180758   0.488406  -2.418   0.0156 *  
time            0.268665   0.059755   4.496 6.92e-06 ***
sexfemale:time  0.001354   0.082590   0.016   0.9869    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
            (Intr) sexfml time  
sexfemale   -0.500              
time        -0.556  0.278       
sexfemal:tm  0.298 -0.550 -0.668</code></pre>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="ModelosNoNormal.html#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sólo la constante aleatoria</span></span>
<span id="cb257-2"><a href="ModelosNoNormal.html#cb257-2" aria-hidden="true" tabindex="-1"></a>modelo3.glmer <span class="ot">&lt;-</span> <span class="fu">glmer</span>(<span class="at">formula =</span> y <span class="sc">~</span> sex<span class="sc">*</span>time <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id),</span>
<span id="cb257-3"><a href="ModelosNoNormal.html#cb257-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> DF, </span>
<span id="cb257-4"><a href="ModelosNoNormal.html#cb257-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">family =</span> binomial)</span>
<span id="cb257-5"><a href="ModelosNoNormal.html#cb257-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo3.glmer)</span></code></pre></div>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: y ~ sex * time + (1 | id)
   Data: DF

     AIC      BIC   logLik deviance df.resid 
   762.7    786.1   -376.4    752.7      795 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.7974 -0.4510 -0.1705  0.3872  9.6837 

Random effects:
 Groups Name        Variance Std.Dev.
 id     (Intercept) 4.038    2.009   
Number of obs: 800, groups:  id, 100

Fixed effects:
               Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    -2.60968    0.43910  -5.943 2.79e-09 ***
sexfemale      -1.31596    0.63367  -2.077   0.0378 *  
time            0.28432    0.03944   7.209 5.64e-13 ***
sexfemale:time  0.03976    0.05413   0.735   0.4626    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
            (Intr) sexfml time  
sexfemale   -0.612              
time        -0.665  0.374       
sexfemal:tm  0.415 -0.679 -0.654</code></pre>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="ModelosNoNormal.html#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vemos cuál es mejor</span></span>
<span id="cb259-2"><a href="ModelosNoNormal.html#cb259-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelo1.glmer, modelo2.glmer, modelo3.glmer)</span></code></pre></div>
<pre><code>Data: DF
Models:
modelo3.glmer: y ~ sex * time + (1 | id)
modelo2.glmer: y ~ sex * time + (1 | id) + (0 + time | id)
modelo1.glmer: y ~ sex * time + (time | id)
              npar    AIC    BIC  logLik deviance   Chisq Df
modelo3.glmer    5 762.71 786.13 -376.36   752.71           
modelo2.glmer    6 736.84 764.95 -362.42   724.84 27.8677  1
modelo1.glmer    7 737.42 770.22 -361.71   723.42  1.4202  1
              Pr(&gt;Chisq)    
modelo3.glmer               
modelo2.glmer  1.299e-07 ***
modelo1.glmer     0.2334    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>No hay diferencias entre el modelo 1 y el 2. Elegimos el modelo 2 que es más simple.</p>
<ul>
<li>Estimación de los efectos fijos e IC de las varianzas</li>
</ul>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="ModelosNoNormal.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="co"># efectos fijos (beta0, beta1)</span></span>
<span id="cb261-2"><a href="ModelosNoNormal.html#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(modelo2.glmer)</span></code></pre></div>
<pre><code>   (Intercept)      sexfemale           time sexfemale:time 
   -2.12911112    -1.18075771     0.26866464     0.00135373 </code></pre>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="ModelosNoNormal.html#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="co"># IC de los efectos fijos </span></span>
<span id="cb263-2"><a href="ModelosNoNormal.html#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="co"># parm = c(3:4) ya que hay 4 coeficientes fijos elijo dos</span></span>
<span id="cb263-3"><a href="ModelosNoNormal.html#cb263-3" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(modelo2.glmer, <span class="at">parm =</span> <span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>))</span></code></pre></div>
<pre><code>                2.5 %     97.5 %
(Intercept) -2.879777 -1.5223834
sexfemale   -2.182534 -0.2371725</code></pre>
<ul>
<li>Varianzas y covarianzas de los efectos aleatorios</li>
</ul>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="ModelosNoNormal.html#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(modelo2.glmer)</span></code></pre></div>
<pre><code> Groups Name        Std.Dev.
 id     (Intercept) 0.96600 
 id.1   time        0.27667 </code></pre>
<ul>
<li>Score tests de los parámetros</li>
</ul>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="ModelosNoNormal.html#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo2.glmer)</span></code></pre></div>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: y ~ sex * time + (1 | id) + (0 + time | id)
   Data: DF

     AIC      BIC   logLik deviance df.resid 
   736.8    765.0   -362.4    724.8      794 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.1926 -0.3595 -0.2348  0.2528  4.2005 

Random effects:
 Groups Name        Variance Std.Dev.
 id     (Intercept) 0.93315  0.9660  
 id.1   time        0.07655  0.2767  
Number of obs: 800, groups:  id, 100

Fixed effects:
                Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    -2.129111   0.341967  -6.226 4.78e-10 ***
sexfemale      -1.180758   0.488406  -2.418   0.0156 *  
time            0.268665   0.059755   4.496 6.92e-06 ***
sexfemale:time  0.001354   0.082590   0.016   0.9869    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
            (Intr) sexfml time  
sexfemale   -0.500              
time        -0.556  0.278       
sexfemal:tm  0.298 -0.550 -0.668</code></pre>
<ul>
<li>Predicciones</li>
</ul>
<p>Para las siguientes combinaciones de las variables:</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="ModelosNoNormal.html#cb269-1" aria-hidden="true" tabindex="-1"></a>newd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">time=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">5</span>), <span class="at">sex=</span><span class="fu">c</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;female&quot;</span>), <span class="at">id=</span><span class="dv">1</span>)</span>
<span id="cb269-2"><a href="ModelosNoNormal.html#cb269-2" aria-hidden="true" tabindex="-1"></a>newd</span></code></pre></div>
<pre><code>  time    sex id
1    0   male  1
2    5   male  1
3   10   male  1
4   15   male  1
5    0 female  1
6    5 female  1
7   10 female  1
8   15 female  1</code></pre>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="ModelosNoNormal.html#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(modelo2.glmer, newd, <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>         1          2          3          4          5          6 
0.05099257 0.11218050 0.22906790 0.41132167 0.01623058 0.03759196 
         7          8 
0.08464839 0.17961529 </code></pre>
<ul>
<li>Gráfico de predicciones</li>
</ul>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="ModelosNoNormal.html#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb273-2"><a href="ModelosNoNormal.html#cb273-2" aria-hidden="true" tabindex="-1"></a>pr.random <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(modelo2.glmer, <span class="fu">c</span>(<span class="st">&quot;time [all]&quot;</span>,<span class="st">&quot;sex&quot;</span>), <span class="at">type=</span><span class="st">&quot;random&quot;</span>)</span>
<span id="cb273-3"><a href="ModelosNoNormal.html#cb273-3" aria-hidden="true" tabindex="-1"></a>pr.random</span></code></pre></div>
<pre><code># Predicted probabilities of y

# sex = male

 time | Predicted |       95% CI
--------------------------------
 0.00 |      0.11 | [0.01, 0.49]
 2.94 |      0.21 | [0.03, 0.67]
 5.17 |      0.32 | [0.06, 0.79]
 7.68 |      0.48 | [0.10, 0.88]
10.03 |      0.64 | [0.16, 0.94]
14.98 |      0.87 | [0.36, 0.99]

# sex = female

 time | Predicted |       95% CI
--------------------------------
 0.00 |      0.04 | [0.00, 0.24]
 2.94 |      0.07 | [0.01, 0.39]
 5.17 |      0.13 | [0.02, 0.54]
 7.68 |      0.23 | [0.03, 0.70]
10.03 |      0.35 | [0.06, 0.83]
14.98 |      0.68 | [0.16, 0.96]

Adjusted for:
* id = 0 (population-level)</code></pre>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="ModelosNoNormal.html#cb275-1" aria-hidden="true" tabindex="-1"></a>pr.fixed <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(modelo2.glmer, <span class="fu">c</span>(<span class="st">&quot;time [all]&quot;</span>,<span class="st">&quot;sex&quot;</span>), <span class="at">type=</span><span class="st">&quot;fixed&quot;</span>)</span>
<span id="cb275-2"><a href="ModelosNoNormal.html#cb275-2" aria-hidden="true" tabindex="-1"></a>pr.fixed</span></code></pre></div>
<pre><code># Predicted probabilities of y

# sex = male

 time | Predicted |       95% CI
--------------------------------
 0.00 |      0.11 | [0.06, 0.19]
 2.94 |      0.21 | [0.13, 0.31]
 5.17 |      0.32 | [0.21, 0.47]
 7.68 |      0.48 | [0.30, 0.67]
10.03 |      0.64 | [0.40, 0.82]
14.98 |      0.87 | [0.60, 0.97]

# sex = female

 time | Predicted |       95% CI
--------------------------------
 0.00 |      0.04 | [0.02, 0.08]
 2.94 |      0.07 | [0.04, 0.14]
 5.17 |      0.13 | [0.07, 0.22]
 7.68 |      0.23 | [0.12, 0.38]
10.03 |      0.35 | [0.18, 0.58]
14.98 |      0.68 | [0.33, 0.90]

Adjusted for:
* id = 0 (population-level)</code></pre>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="ModelosNoNormal.html#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb277-2"><a href="ModelosNoNormal.html#cb277-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb277-3"><a href="ModelosNoNormal.html#cb277-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(pr.random) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;random&quot;</span>),</span>
<span id="cb277-4"><a href="ModelosNoNormal.html#cb277-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(pr.fixed) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;fixed&quot;</span>),</span>
<span id="cb277-5"><a href="ModelosNoNormal.html#cb277-5" aria-hidden="true" tabindex="-1"></a><span class="at">nrow=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="fig_out/unnamed-chunk-156-1.png" width="672" /></p>
<p><strong>Usando la función <code>mixed_model</code></strong></p>
<p>El modelo escogido usando el <code>glmer</code> se ajustaría con la siguiente sintaxis:</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="ModelosNoNormal.html#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GLMMadaptive)</span>
<span id="cb278-2"><a href="ModelosNoNormal.html#cb278-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-3"><a href="ModelosNoNormal.html#cb278-3" aria-hidden="true" tabindex="-1"></a>modelo2.mixed <span class="ot">&lt;-</span> <span class="fu">mixed_model</span>(<span class="at">fixed =</span> y <span class="sc">~</span> sex<span class="sc">*</span>time,</span>
<span id="cb278-4"><a href="ModelosNoNormal.html#cb278-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">random =</span> <span class="sc">~</span> time <span class="sc">||</span> id,</span>
<span id="cb278-5"><a href="ModelosNoNormal.html#cb278-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> DF,</span>
<span id="cb278-6"><a href="ModelosNoNormal.html#cb278-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">family =</span> binomial)</span>
<span id="cb278-7"><a href="ModelosNoNormal.html#cb278-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo2.mixed)</span></code></pre></div>
<pre><code>
Call:
mixed_model(fixed = y ~ sex * time, random = ~time || id, data = DF, 
    family = binomial)

Data Descriptives:
Number of Observations: 800
Number of Groups: 100 

Model:
 family: binomial
 link: logit 

Fit statistics:
   log.Lik      AIC      BIC
 -359.4719 730.9439 746.5749

Random effects covariance matrix:
            StdDev
(Intercept) 0.9705
time        0.2910

Fixed effects:
               Estimate Std.Err z-value  p-value
(Intercept)     -2.1282  0.3399 -6.2604  &lt; 1e-04
sexfemale       -1.1903  0.4937 -2.4109 0.015915
time             0.2701  0.0611  4.4183  &lt; 1e-04
sexfemale:time   0.0031  0.0848  0.0371 0.970435

Integration:
method: adaptive Gauss-Hermite quadrature rule
quadrature points: 11

Optimization:
method: hybrid EM and quasi-Newton
converged: TRUE </code></pre>
<ul>
<li>efectos condicionales e intervalos de confianza</li>
</ul>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="ModelosNoNormal.html#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(modelo2.mixed)</span></code></pre></div>
<pre><code>                    2.5 %     Estimate     97.5 %
(Intercept)    -2.7944495 -2.128177211 -1.4619049
sexfemale      -2.1579607 -1.190288979 -0.2226173
time            0.1502626  0.270061739  0.3898609
sexfemale:time -0.1631059  0.003143801  0.1693935</code></pre>
<ul>
<li>efectos marginales e intervalos de confianza</li>
</ul>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="ModelosNoNormal.html#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">marginal_coefs</span>(modelo2.mixed, <span class="at">std_errors =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>               Estimate Std.Err z-value   p-value
(Intercept)     -1.5846  0.2558 -6.1937   &lt; 1e-04
sexfemale       -1.0912  0.3769 -2.8957 0.0037835
time             0.1738  0.0302  5.7456   &lt; 1e-04
sexfemale:time   0.0516  0.0434  1.1874 0.2350639</code></pre>
<ul>
<li>Estimación de las varianzas de los efectos aleatorios con sus intervalos de confianza</li>
</ul>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="ModelosNoNormal.html#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(modelo2.mixed, <span class="at">parm =</span> <span class="st">&quot;var-cov&quot;</span>)</span></code></pre></div>
<pre><code>                    2.5 %   Estimate    97.5 %
var.(Intercept) 0.2271032 0.94180306 3.9056830
var.time        0.0448401 0.08469908 0.1599893</code></pre>
<ul>
<li>Predicciones</li>
</ul>
<p>Para las siguientes combinaciones de las variables:</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="ModelosNoNormal.html#cb286-1" aria-hidden="true" tabindex="-1"></a>newd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">time=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">5</span>), <span class="at">sex=</span><span class="fu">c</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;female&quot;</span>))</span>
<span id="cb286-2"><a href="ModelosNoNormal.html#cb286-2" aria-hidden="true" tabindex="-1"></a>newd</span></code></pre></div>
<pre><code>  time    sex
1    0   male
2    5   male
3   10   male
4   15   male
5    0 female
6    5 female
7   10 female
8   15 female</code></pre>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="ModelosNoNormal.html#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(modelo2.mixed, newd, <span class="at">type =</span> <span class="st">&quot;marginal&quot;</span>)</span></code></pre></div>
<pre><code>         1          2          3          4          5          6 
0.17014959 0.32836686 0.53827642 0.73543836 0.06441622 0.17525201 
         7          8 
0.39606205 0.66930686 </code></pre>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="ModelosNoNormal.html#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(modelo2.mixed, newd, <span class="at">type =</span> <span class="st">&quot;mean_subject&quot;</span>)</span></code></pre></div>
<pre><code>         1          2          3          4          5          6 
0.10638816 0.31477945 0.63932604 0.87244465 0.03494309 0.12428771 
         7          8 
0.35745881 0.68559754 </code></pre>
<p>y con los errores estándar (del predictor lineal).</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="ModelosNoNormal.html#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(modelo2.mixed, newd, <span class="at">type =</span> <span class="st">&quot;marginal&quot;</span>, <span class="at">se.fit=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>$pred
         1          2          3          4          5          6 
0.17014959 0.32836686 0.53827642 0.73543836 0.06441622 0.17525201 
         7          8 
0.39606205 0.66930686 

$se.fit
        1         2         3         4         5         6 
0.2558341 0.1980894 0.2424415 0.3522307 0.3249897 0.2098850 
        7         8 
0.2067862 0.3189744 </code></pre>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="ModelosNoNormal.html#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(modelo2.mixed, newd, <span class="at">type =</span> <span class="st">&quot;mean_subject&quot;</span>, <span class="at">se.fit=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>$pred
         1          2          3          4          5          6 
0.10638816 0.31477945 0.63932604 0.87244465 0.03494309 0.12428771 
         7          8 
0.35745881 0.68559754 

$se.fit
        1         2         3         4         5         6 
0.3399411 0.3099182 0.5131671 0.7857693 0.4358726 0.3421853 
        7         8 
0.4913996 0.7504220 </code></pre>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="ModelosNoNormal.html#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;effects&quot;</span>)</span>
<span id="cb296-2"><a href="ModelosNoNormal.html#cb296-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predictorEffect</span>(<span class="st">&quot;time&quot;</span>, modelo2.mixed), <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<p><img src="fig_out/unnamed-chunk-164-1.png" width="672" /></p>
<p>Para el modelo ajustado con <code>mixed_model</code>, las funciones <code>summary</code>, <code>confint</code>, <code>predict</code> y <code>marginal_coefs</code>, tiene el argumento <code>sandwich=TRUE</code> con el que los errores estándar se calculan mediante el método sandwich (más robusto). Sin embargo, sólo funciona si el modelo tiene sólo la constante aleatoria.</p>
</div>
</div>
<div id="generalized-estimation-equations" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> <em>Generalized Estimation Equations</em></h2>
<div id="ecuación-2" class="section level3" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Ecuación</h3>
<p>Los modelo GEE (“Generalized Estimation Equations”), se basan en la primera derivada de la función de verosimilitud, y encontrar los parámetros que igualen esta derivada a cero.</p>
<p>Es importante remarcar que <strong>no se basan propiamente en la función de verosimilitud</strong>. Por lo tanto, no se podrán realizar contrastes de LRT para comparar modelos anidados ni obtener los índices AIC ni BIC.</p>
<p>En su lugar, sí que se pueden calcular los QIC (“quasi-likelihood information criteria”) para comparar modelos.</p>
</div>
<div id="función-geeglm" class="section level3" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Función <code>geeglm</code></h3>
<p>Para ajustar los modelos GEE usaremos la función <code>geeglm</code> del package <strong><code>geepack</code></strong>, el cual es una extensión del paquete <code>gee</code>. El valor añadio de <code>geepack</code> es que aporta la función <code>QIC</code> (“quasi-likelihood information criteria”) que permite comparar modelos para escojer entre matrices de correlación de los errores.</p>
<p>Las posibles <strong>matrices de correlación</strong> (“working matrices”) son:</p>
<ul>
<li>“independence”</li>
<li>“exchangeable”</li>
<li>“ar1”</li>
<li>“unstructured”</li>
<li>“userdefined”</li>
</ul>
<p>El argumento <code>weights</code> de la función <code>geeglm</code> tiene el mismo significado y funcionamiento que en la función <code>glmer</code>, o sea que es un vector de pesos para cada observación.</p>
</div>
<div id="ejemplos-3" class="section level3" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> Ejemplos</h3>
<p>Fíjate en el argumento <code>waves</code>.</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="ModelosNoNormal.html#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geepack)</span>
<span id="cb297-2"><a href="ModelosNoNormal.html#cb297-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-3"><a href="ModelosNoNormal.html#cb297-3" aria-hidden="true" tabindex="-1"></a>modelo2.gee <span class="ot">&lt;-</span> <span class="fu">geeglm</span>(<span class="at">formula =</span> y <span class="sc">~</span> sex<span class="sc">*</span>time,</span>
<span id="cb297-4"><a href="ModelosNoNormal.html#cb297-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">id =</span> id,</span>
<span id="cb297-5"><a href="ModelosNoNormal.html#cb297-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">waves =</span> time,</span>
<span id="cb297-6"><a href="ModelosNoNormal.html#cb297-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">corstr =</span> <span class="st">&quot;ar1&quot;</span>,</span>
<span id="cb297-7"><a href="ModelosNoNormal.html#cb297-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">binomial</span>(),</span>
<span id="cb297-8"><a href="ModelosNoNormal.html#cb297-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">std.err =</span> <span class="st">&quot;san.se&quot;</span>, <span class="co">#default; others: &#39;jack&#39;, &#39;j1s&#39;, &#39;fij&#39;</span></span>
<span id="cb297-9"><a href="ModelosNoNormal.html#cb297-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> DF)</span>
<span id="cb297-10"><a href="ModelosNoNormal.html#cb297-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo2.gee)</span></code></pre></div>
<pre><code>
Call:
geeglm(formula = y ~ sex * time, family = binomial(), data = DF, 
    id = id, waves = time, corstr = &quot;ar1&quot;, std.err = &quot;san.se&quot;)

 Coefficients:
               Estimate  Std.err   Wald Pr(&gt;|W|)    
(Intercept)    -1.48199  0.24155 37.643 8.50e-10 ***
sexfemale      -1.10837  0.36403  9.271  0.00233 ** 
time            0.15915  0.02656 35.900 2.08e-09 ***
sexfemale:time  0.05526  0.03923  1.985  0.15891    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation structure = ar1 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    1.004  0.1171
  Link = identity 

Estimated Correlation Parameters:
      Estimate  Std.err
alpha   0.9936 0.001097
Number of clusters:   100  Maximum cluster size: 8 </code></pre>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="ModelosNoNormal.html#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelo2.gee)</span></code></pre></div>
<pre><code>Analysis of &#39;Wald statistic&#39; Table
Model: binomial, link: logit
Response: y
Terms added sequentially (first to last)

         Df   X2 P(&gt;|Chi|)    
sex       1  3.0     0.085 .  
time      1 86.6    &lt;2e-16 ***
sex:time  1  2.0     0.159    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="ModelosNoNormal.html#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">QIC</span>(modelo2.gee)</span></code></pre></div>
<pre><code>      QIC      QICu Quasi Lik       CIC    params      QICC 
  918.317   919.327  -455.663     3.495     4.000   918.393 </code></pre>
<p>Por defecto, los errores estándard se calculan mediante el método sandwich. Otra posibilidad es usar el método jacknife.</p>
<p>Comparamos los resultados de los coeficientes fijos con la función <code>glmer</code>, <code>mixed_model</code> (modelos mixtos) y la función <code>geeglm</code> (GEE):</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="ModelosNoNormal.html#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(modelo2.glmer))</span></code></pre></div>
<pre><code>                Estimate Std. Error  z value  Pr(&gt;|z|)
(Intercept)    -2.129111    0.34197 -6.22606 4.783e-10
sexfemale      -1.180758    0.48841 -2.41758 1.562e-02
time            0.268665    0.05976  4.49607 6.922e-06
sexfemale:time  0.001354    0.08259  0.01639 9.869e-01</code></pre>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="ModelosNoNormal.html#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(modelo2.mixed))</span></code></pre></div>
<pre><code>                Estimate Std.Err  z-value   p-value
(Intercept)    -2.128177 0.33994 -6.26043 3.839e-10
sexfemale      -1.190289 0.49372 -2.41086 1.591e-02
time            0.270062 0.06112  4.41832 9.947e-06
sexfemale:time  0.003144 0.08482  0.03706 9.704e-01</code></pre>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="ModelosNoNormal.html#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">marginal_coefs</span>(modelo2.mixed, <span class="at">std_errors =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>               Estimate Std.Err z-value p-value
(Intercept)     -1.5846  0.2558  -6.194  &lt;1e-04
sexfemale       -1.0912  0.3769  -2.896  0.0038
time             0.1738  0.0302   5.746  &lt;1e-04
sexfemale:time   0.0516  0.0434   1.187  0.2351</code></pre>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="ModelosNoNormal.html#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(modelo2.gee))</span></code></pre></div>
<pre><code>               Estimate Std.err   Wald  Pr(&gt;|W|)
(Intercept)    -1.48199 0.24155 37.643 8.496e-10
sexfemale      -1.10837 0.36403  9.271 2.329e-03
time            0.15915 0.02656 35.900 2.077e-09
sexfemale:time  0.05526 0.03923  1.985 1.589e-01</code></pre>
</div>
</div>
<div id="ejercicios-2" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Ejercicios</h2>
<div id="ejercicio-5b" class="section level3" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> Ejercicio 5b</h3>
<p>Analiza los datos <code>toenail</code> disponible en el package <code>HSAUR3</code>. En ellos hay la información de un estudio para comparar dos fármacos sobre la evolución de una infección.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="ModelosNoNormal.html#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HSAUR3)</span>
<span id="cb311-2"><a href="ModelosNoNormal.html#cb311-2" aria-hidden="true" tabindex="-1"></a>?toenail</span></code></pre></div>
<p>Analiza cómo cambia el riesgo de paceder una infección moderada o severa (“moderate or severe”) a lo largo de las visitas y según el tratamiento. Empieza por visualizar los datos y hacer una descriptiva. Después, para contestar a la pregunta científica, prueba de usar tanto las funciones para ajustar los modelos GLMM como para los modelos GEE.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelos-lineales-mixtos-lmm.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="análisis-de-supervivencia-con-datos-longitudinales.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/isglobal-brge/curso_longitudinal/tree/master/docs05b-ModelosNoNormal.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["cursoLongitudinal-bookdown.pdf", "cursoLongitudinal-bookdown.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
